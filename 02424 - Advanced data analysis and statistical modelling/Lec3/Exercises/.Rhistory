x = seq(-1,8,length.out = 10)
x
y = c(1.4,4.7,5.1,8.3,9.0,14.5,14.0,13.4,19.2,18)
y
lm(x,y)
lm(y~x)
fit = lm(y~x)
plot(fit)
bin(3,4)
length(x)
x = c(13,5,28,28,15,4,13,4,10,17,11,13,12,17,3)
length(x)
fun <= function(theta, x){
- sum(dnbinom(x, theta[1], theta[2], log = TRUE))
}
nlminb(c(0,1),fun,y=x,lower=c(-Inf,0), upper = c(Inf,1))
x = c(13,5,28,28,15,4,13,4,10,17,11,13,12,17,3)
fun <= function(theta, x){
- sum(dnbinom(x, theta[1], theta[2], log = TRUE))
}
fun <- function(theta, x){
- sum(dnbinom(x, theta[1], theta[2], log = TRUE))
}
nlminb(c(0,1),fun,y=x,lower=c(-Inf,0), upper = c(Inf,1))
fun <- function(theta, y){
- sum(dnbinom(x, theta[1], theta[2], log = TRUE))
}
nlminb(c(0,1),fun,y=x,lower=c(-Inf,0), upper = c(Inf,1))
fun <- function(theta, x){
- sum(dnbinom(x, theta[1], theta[2], log = TRUE))
}
nlminb(c(0,1),fun,x=x,lower=c(-Inf,0), upper = c(Inf,1))
nlminb(c(0,1),fun,x=x,lower=c(0,0), upper = c(Inf,1))
nlminb(c(1,0.5),fun,x=x,lower=c(0,0), upper = c(Inf,1))
nlminb(c(1,0.5),fun,x=x,lower=c(0.0000001,0.0000001), upper = c(Inf,0.9999999))
# ex1
plot(4.4,3.4,3.3,2.5,7.3,4.9,4.8,4.4)
# ex1
plot(c(4.4,3.4,3.3,2.5,7.3,4.9,4.8,4.4))
# ex1
plot(c(4.4,3.4,3.3,2.5,7.3,4.9,4.8,4.4), ylim = c(0,8))
# ex1
plot(c(4.4,3.4,3.3,2.5,7.3,4.9,4.8,4.4), ylim = c(0,8), xlim = c(0,8))
grid()
X =matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,2,3,4,5,6,7,8),3,8)
length(c(1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,2,3,4,5,6,7,8))
X =matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,2,3,4,5,6,7,8),3,8)
X
X =matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,2,3,4,5,6,7,8),8,3)
X
# ex1
Y = c(4.4,3.4,3.3,2.5,7.3,4.9,4.8,4.4)
plot(Y, ylim = c(0,8), xlim = c(0,8))
grid()
X =matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,2,3,4,5,6,7,8),8,3)
#ex2
beta = solve(t(X)%*%X)*t(X)%*%log(Y)
#ex2
beta = solve(t(X)%*%X)*t(X)%*%log(t(Y))
#ex2
beta = solve(t(X)%*%X)
t(X)%*%
log(Y)
t(X)%*%log(Y)
#ex2
beta = solve(t(X)%*%X)%*%t(X)%*%log(Y)
beta
r(1,2,3)
#ex3
exp(t(c(1,1,9))%*%beta)
#ex3
exp(t(c(1,0,9))%*%beta)
10^(-0.1632612)
10^(-1.1059788)
10^(1.1059788)
10^(-1.1059788)
############################## Q2 ###########################
read.csv(ozone.data.csv, header = T, sep = "")
setwd('C:\\Users\\anton\\OneDrive - KÃ¸benhavns Universitet\\Uni\\Uni\\10. semester\\02424 - adv stat\\Lec3\\Exercises')
############################## Q2 ###########################
read.csv(ozone.data.csv, header = T, sep = "")
############################## Q2 ###########################
read.csv("ozone.data.csv", header = T, sep = "")
############################## Q2 ###########################
data = read.csv("ozone.data.csv", header = T, sep = "")
############################## Q2 ###########################
data = read.csv("SO2.csv", header = T, sep = "")
data
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19, col = my_cols[iris$Species])
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("corr = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0(expression(rho),"=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0(bquote(rho),"=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- bquote(expression(rho),"=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
txt <- bquote(expression(rho)=, r)
expression(rho=r)
expression(rho=0)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- bquote(.expression(rho),"=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
txt <- bquote(.expression(rho) = ~ r)
bquote(.expression(rho) = ~ .r)
bquote(.expression(rho) ~ = ~ .r)
bquote(.expression(rho) ~ = ~ .r)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0(expression(rho), "=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- bquote(expression(rho), "=", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- bquote(expression(rho), paste0("=", r))
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- bquote(expression(rho), .paste0("=", r))
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- expression((rho), paste0("=", r))
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- expression((rho), paste("=", r))
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("corr =", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
# Correlation panel
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("corr = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
## ex2 ##
model1 = lm(data$Pollution ~ data$Industry + 1)
model1
model3 = lm(data$Pollution ~ data$Industry + data$Temp + data$Wet.days + 1)
summary(model1)
summary(model2)
## ex2 ##
model1 = lm(data$Pollution ~ data$Industry + 1)
summary(model1)
model2 = lm(data$Pollution ~ data$Industry + data$Temp + 1)
summary(model2)
model3 = lm(data$Pollution ~ data$Industry + data$Temp + data$Wet.days + 1)
summary(model3)
summary(model2)
plot(model1)
model4 = lm(data$Pollution ~ data$Industry + data$Temp + data$Population + 1)
summary(model4)
model4 = lm(data$Pollution ~ data$Industry + data$Population + 1)
summary(model4)
model2 = lm(data$Pollution ~ data$Industry + data$Temp + 1)
summary(model2)
model2 = lm(data$Pollution ~ data$Industry + data$Population + 1)
summary(model2)
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("corr = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y, pch = 19)
}
# Create the plots
pairs(data,
lower.panel = panel.cor,
upper.panel = upper.panel)
model2 = lm(data$Pollution ~ data$Industry + data$Population + data$Temp + 1)
summary(model2)
## ex2 ##
model1 = lm(data$Pollution ~ data$Industry + 1)
summary(model1)
model2 = lm(data$Pollution ~ data$Industry + data$Population + 1)
summary(model2)
anova(model1,model2)
data
data[22]
model3 = lm(data$Pollution ~ data$Industry + data$Population + data$Temp + 1)
summary(model3)
data
data2 = data[-22,]
data2
pairs(data2,
lower.panel = panel.cor,
upper.panel = upper.panel)
# we conclude at model 2.
model1 = lm(data2$Pollution ~ data2$Industry + 1)
summary(model1)
model2 = lm(data2$Pollution ~ data2$Industry + data$Population + 1)
model2 = lm(data2$Pollution ~ data2$Industry + data2$Population + 1)
summary(model2)
anova(model1,model2)
model3 = lm(data2$Pollution ~ data2$Industry + data2$Population + data2$Temp + 1)
summary(model3)
model3 = lm(data2$Pollution ~ data2$Industry + data2$Population + data2$Wet.days + 1)
summary(model3)
